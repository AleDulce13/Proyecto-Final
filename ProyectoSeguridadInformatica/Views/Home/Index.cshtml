@{
    ViewData["Title"] = "Inicio";
}

<div class="security-hero">
    <div class="row mb-4">
        <div class="col-lg-7 mb-4 mb-lg-0">
            <div class="security-card">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <div class="security-pill mb-3">
                            <span class="security-pill-dot"></span>
                            Laboratorio práctico de seguridad web
                        </div>
                        <h1 class="security-hero-title mb-2">
                            Seguridad informática aplicada a
                            <span class="security-hero-highlight">autenticación y cifrado</span>
                        </h1>
                    </div>
                    <div class="text-end">
                        <div class="security-kpi">2</div>
                        <div class="security-kpi-label">Módulos críticos<br />del sitio</div>
                    </div>
                </div>

                <p class="security-hero-lead mb-3">
                    Este sitio simula un entorno seguro donde los usuarios se registran, inician sesión
                    y utilizan cifrado simétrico AES con contraseña para proteger texto sensible.
                    Está pensado como un <strong>laboratorio educativo</strong>, por lo que combina buenas prácticas
                    de seguridad con algunas limitaciones deliberadas.
                </p>
            </div>
        </div>

        <div class="col-lg-5">
            <div class="security-card security-card-light h-100">
                <h2 class="security-section-title mb-3">Resumen de la arquitectura</h2>
                <p class="security-section-subtitle mb-3">
                    El proyecto se basa en ASP.NET Core MVC con sesiones y servicios dedicados para
                    autenticación y cifrado:
                </p>

                <ul class="security-list mb-3">
                    <li>
                        Autenticación delegada en <strong>Firebase Auth</strong> :
                        la aplicación nunca almacena contraseñas, sólo consume tokens emitidos por Firebase.
                    </li>
                    <li>
                        Servicio <strong>FirebaseUserService</strong> para leer y guardar el perfil básico
                        de usuario en Firebase Realtime Database usando <code>IdToken</code> por petición.
                    </li>
                    <li>
                        Servicio <strong>AesService</strong> que cifra y descifra usando AES (cifrado simétrico)
                        a partir de una contraseña que introduce el propio usuario.
                    </li>
                    <li>
                        Controladores protegidos con <strong>cookies de autenticación</strong> y
                        <code>[Authorize]</code> para limitar el acceso a las acciones de cifrado y descifrado.
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="row gy-4">
        <div class="col-md-6">
            <div class="security-card h-100">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="security-section-title mb-0">¿Qué hace seguro a este sitio?</h2>
                    <span class="security-badge security-badge--ok">Defensas aplicadas</span>
                </div>

                <ul class="security-list mb-3">
                    <li>
                        <strong>Autenticación gestionada por Firebase</strong>  
                        Las credenciales se validan en Firebase Auth y la aplicación sólo maneja tokens
                        de acceso. No se almacenan contraseñas ni hashes locales.
                    </li>
                    <li>
                        <strong>Cifrado simétrico con AES</strong>  
                        El texto que se cifra desde la sección de criptografía se protege con AES derivando la clave
                        de una contraseña elegida por el usuario mediante PBKDF2, lo que dificulta ataques de fuerza bruta.
                    </li>
                    <li>
                        <strong>Protección de rutas sensibles</strong>  
                        Las acciones de <em>Encriptar</em> y <em>Desencriptar</em> en el controlador de criptografía
                        sólo son accesibles si la sesión está autenticada; en caso contrario, se redirige al login
                        con un mensaje claro.
                    </li>
                    <li>
                        <strong>Tokens antifalsificación (CSRF)</strong>  
                        Los formularios críticos (`Register`, `Login`, `Encrypt`, `Decrypt`) usan
                        <code>[ValidateAntiForgeryToken]</code>, reduciendo el riesgo de ataques CSRF.
                    </li>
                    <li>
                        <strong>Validación de entrada</strong>  
                        Los modelos de vista validan campos obligatorios y se muestran errores de forma explícita,
                        disminuyendo problemas derivados de entradas incompletas o malformadas.
                    </li>
                </ul>

                <p class="security-note mb-0">
                    En conjunto, estas capas ilustran cómo <strong>autenticación, cifrado y validación</strong>
                    trabajan juntas para proteger la información de los usuarios.
                </p>
            </div>
        </div>

        <div class="col-md-6">
            <div class="security-card h-100">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="security-section-title mb-0">Resiliencia y monitorización</h2>
                    <span class="security-badge security-badge--ok">Defensas activas</span>
                </div>

                <ul class="security-list mb-3">
                    <li>
                        <strong>Rate limiting y anti‑bruteforce</strong>  
                        El acceso a login y registro está protegido con limitadores de tasa nativos de ASP.NET Core
                        y un contador de intentos por email + IP + dispositivo, reduciendo ataques de fuerza bruta.
                    </li>
                    <li>
                        <strong>Resiliencia con Polly</strong>  
                        Las llamadas a Firebase usan reintentos con retroceso exponencial y <em>circuit breaker</em>,
                        protegiendo el sistema frente a fallos temporales del backend externo.
                    </li>
                    <li>
                        <strong>Logging de eventos críticos</strong>  
                        Se registran intentos de login, bloqueos por demasiados intentos, errores globales
                        y activación de políticas de resiliencia, facilitando la detección de abusos y problemas.
                    </li>
                </ul>

                <p class="security-note mb-0">
                    Estas capacidades ayudan a que el sistema falle de forma controlada y permita
                    analizar qué está ocurriendo durante un ataque o incidente.
                </p>
            </div>
        </div>
    </div>
</div>
